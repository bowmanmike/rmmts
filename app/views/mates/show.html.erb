<div class="full-container">
  <div class="profile-card">
    <% if @mate.mate_avatar.present? %>
      <%= image_tag @mate.mate_avatar, class: "mate-profile-avatar" %>
    <% end %>
    <div class="mate-summary">
      <h3><%= @mate.full_name %></h3>
      <p>
        Username: <%= @mate.username %><br>
        <% if @mate.house %>
          Lives at <%= @mate.house.name %>
        <% else %>
          You haven't joined a house yet. <%= link_to "Find one.", houses_path %>
        <% end %>
      </p>
    </div>

    <div class="mate-point-summary">
      <div class="point-total">
        <%= link_to (@mate.points.sum(:amount) || 0), mate_points_path(@mate) %>
      </div>
      <div class="point-subtitle">
        Points
      </div>
    </div>

    <% if @mate == current_user %>
      <%= link_to button_tag("Edit profile"), edit_mate_path(@mate), class: "edit-mate-link", remote: true %>
    <% end %>
  </div>
</div>

<div id="announcements" class="full-container">
  <% if current_user.house == nil %>
    <div class="no-house-profile">
      <h2>Welcome to Chortal! To get started, create or join a house, or wait to be invited by your housemates.</h2>
    </div>
  <% end %>

  <% if current_user.house %>
    <div class="full-card">
      <div class="full-card-header">
        <h3>Announcements</h3>
        <%= link_to image_tag("add.svg", class: "medium-icon"), new_house_announcement_path(@house), class: "medium-icon-link new-announcement-button", remote: true %>
      </div>
      <% if @announcements.any? %>
        <div class="announcement-counter">
          <strong><%= @announcements.count %></strong> announcements
          <%= button_tag "Show", id: "show-announcements-button" %>
          <%= button_tag "Hide", id: "hide-announcements-button", class: "hidden-button" %>
        </div>
      <% end %>
      <div id="announcements-list" class="full-card-list">
        <%= render(@announcements) || "No announcements!" %>
      </div>
    </div>
  </div>

  <div id="mate-duties" class="full-container">

    <div id="mate-chores" class="chores-container card-container">
      <div id="mate-chores-header" class="card-header">
        <h3>Chores</h3>
        <%= link_to image_tag("add.svg", class: "medium-icon"), new_house_chore_path(@house), class: "medium-icon-link new-chore-button", remote: true %>
      </div>
      <div id="mate-chores-list" class="card-list">
        <%= render @chores %>
      </div>
    </div>
    <div id="mate-expenses" class="card-container">
      <div id="mate-expenses-header" class="card-header">
        <h3>Expenses</h3>
        <%= link_to image_tag("add.svg", class: "medium-icon"), new_house_expense_path(@house), class: "medium-icon-link edit-expense-button", remote: true %>
      </div>
      <div id="mate-expenses-list" class="expenses-list card-list">
        <%= render @expenses || "No current expenses." %>
      </div>
    </div>
  </div>

  <div class="purchases-container full-container">

    <div id="mate-owed-payments" class="purchases-container card-container">
      <div id="mate-owed-payments-header" class="card-header">
        <h3>
          <% if @mate == current_user %>
            You Owe:
          <% else %>
            <%= @mate.first_name.capitalize %> Owes:
          <% end %>
          <%= number_to_currency(@mate.sum_owed_to_mates) %>
        </h3>
      </div>
      <div id="mate-owed-payments-list" class="card-list">
        <% if @housemate_purchases.any? %>
          <%= render @housemate_purchases %>
        <% else %>
          <p>No purchases yet.</p>
        <% end %>
      </div>
    </div>

    <div id="mate-purchases" class="purchases-container card-container">
      <div id="mate-purchases-header" class="card-header">
        <h3>
          <% if @mate == current_user %>
            You Are Owed:
          <% else %>
            <%= @mate.first_name.capitalize %> Is Owed:
          <% end %>
          <%= number_to_currency(@mate.sum_owed_to_self) %>
        </h3>
        <% if @mate == current_user %>
          <%= link_to image_tag("add.svg", class: "medium-icon"), new_mate_purchase_path(@mate), class: "medium-icon-link new-purchase-button", remote: true %>
        <% end %>
      </div>
      <div id="mate-purchases-list" class="card-list">
        <% if @purchases.any? %>
          <%= render @purchases %>
        <% else %>
          <p>No purchases yet.</p>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
